CREATE TABLE [emdbuser].[LOANXDB_N_07]
(
[XrefId] [int] NOT NULL,
[_NEWHUD_X210] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___NEWH__57928B5E] DEFAULT ((0.0)),
[_NEWHUD_X661] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___NEWH__5886AF97] DEFAULT ((0.0)),
[_NEWHUD_X104] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___NEWH__597AD3D0] DEFAULT ((0.0)),
[_NEWHUD_X555] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___NEWH__5A6EF809] DEFAULT ((0.0)),
[_NEWHUD_X138] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___NEWH__5B631C42] DEFAULT ((0.0)),
[_NEWHUD_X694] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___NEWH__5C57407B] DEFAULT ((0.0)),
[_NEWHUD_X37] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___NEWH__5D4B64B4] DEFAULT ((0.0)),
[_NEWHUD_X612] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___NEWH__5E3F88ED] DEFAULT ((0.0)),
[_NEWHUD_X211] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___NEWH__5F33AD26] DEFAULT ((0.0)),
[_NEWHUD_X731] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___NEWH__6027D15F] DEFAULT ((0.0)),
[_NEWHUD_X414] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___NEWH__611BF598] DEFAULT ((0.0)),
[_NEWHUD_X52] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___NEWH__621019D1] DEFAULT ((0.0)),
[_NEWHUD_X730] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___NEWH__63043E0A] DEFAULT ((0.0)),
[_NEWHUD_X92] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___NEWH__63F86243] DEFAULT ((0.0)),
[_NEWHUD_X718] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___NEWH__64EC867C] DEFAULT ((0.0)),
[_NEWHUD_X27] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___NEWH__65E0AAB5] DEFAULT ((0.0)),
[_NEWHUD_X610] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___NEWH__66D4CEEE] DEFAULT ((0.0)),
[_NEWHUD_X693] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___NEWH__67C8F327] DEFAULT ((0.0)),
[_NEWHUD_X140] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___NEWH__68BD1760] DEFAULT ((0.0)),
[_NEWHUD_X606] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___NEWH__69B13B99] DEFAULT ((0.0)),
[_NEWHUD_X670] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___NEWH__6AA55FD2] DEFAULT ((0.0)),
[_NEWHUD_X9] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___NEWH__6B99840B] DEFAULT ((0.0)),
[_NEWHUD_X98] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___NEWH__6C8DA844] DEFAULT ((0.0)),
[_NEWHUD_X139] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___NEWH__6D81CC7D] DEFAULT ((0.0)),
[_NEWHUD_X667] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___NEWH__6E75F0B6] DEFAULT ((0.0)),
[_NEWHUD_X314] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___NEWH__6F6A14EF] DEFAULT ((0.0)),
[_NEWHUD_X330] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___NEWH__705E3928] DEFAULT ((0.0)),
[_NEWHUD_X707] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___NEWH__71525D61] DEFAULT ((0.0)),
[_NEWHUD_X596] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___NEWH__7246819A] DEFAULT ((0.0)),
[_NEWHUD_X724] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___NEWH__733AA5D3] DEFAULT ((0.0)),
[_NEWHUD_X692] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___NEWH__742ECA0C] DEFAULT ((0.0)),
[_NEWHUD_X217] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___NEWH__7522EE45] DEFAULT ((0.0)),
[_NEWHUD_X664] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___NEWH__7617127E] DEFAULT ((0.0)),
[_NEWHUD_X315] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___NEWH__770B36B7] DEFAULT ((0.0)),
[_NEWHUD_X702] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___NEWH__77FF5AF0] DEFAULT ((0.0)),
[_374] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N____374__78F37F29] DEFAULT ((0.0)),
[_CX_HPMLCHGVAL_16] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_H__79E7A362] DEFAULT ((0.0)),
[_CX_GFE800] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_G__7ADBC79B] DEFAULT ((0.0)),
[_CX_GFE1300] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_G__7BCFEBD4] DEFAULT ((0.0)),
[_CX_GFE1100] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_G__7CC4100D] DEFAULT ((0.0)),
[_CX_GFE900] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_G__7DB83446] DEFAULT ((0.0)),
[_CX_GFEVERSNUMB] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_G__7EAC587F] DEFAULT ((0.0)),
[_CX_GFECREDITS] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_G__7FA07CB8] DEFAULT ((0.0)),
[_2295] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___2295__0094A0F1] DEFAULT ((0.0)),
[_2221] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___2221__0188C52A] DEFAULT ((0.0)),
[_2218] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___2218__027CE963] DEFAULT ((0.0)),
[_CX_SECINVPER] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_S__03710D9C] DEFAULT ((0.0)),
[_CX_CHANGEINFO] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_C__046531D5] DEFAULT ((0.0)),
[_2105] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___2105__0559560E] DEFAULT ((0.0)),
[_2150] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___2150__064D7A47] DEFAULT ((0.0)),
[_2142] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___2142__07419E80] DEFAULT ((0.0)),
[_1095] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___1095__0835C2B9] DEFAULT ((0.0)),
[_1115] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___1115__0929E6F2] DEFAULT ((0.0)),
[_1647] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___1647__0A1E0B2B] DEFAULT ((0.0)),
[_3134] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___3134__0B122F64] DEFAULT ((0.0)),
[_141] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N____141__0C06539D] DEFAULT ((0.0)),
[_2277] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___2277__0CFA77D6] DEFAULT ((0.0)),
[_2276] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___2276__0DEE9C0F] DEFAULT ((0.0)),
[_L260] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___L260__0EE2C048] DEFAULT ((0.0)),
[_CX_OTHERFEETOT] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_O__0FD6E481] DEFAULT ((0.0)),
[_CX_GFEDWNPMT] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_G__10CB08BA] DEFAULT ((0.0)),
[_CX_GFELOANBAL] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_G__11BF2CF3] DEFAULT ((0.0)),
[_1386] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___1386__12B3512C] DEFAULT ((0.0)),
[_SERVICE_X16] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___SERV__13A77565] DEFAULT ((0.0)),
[_SERVICE_X30] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___SERV__149B999E] DEFAULT ((0.0)),
[_SERVICE_X34] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___SERV__158FBDD7] DEFAULT ((0.0)),
[_SERVICE_X21] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___SERV__1683E210] DEFAULT ((0.0)),
[_SERVICE_X25] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___SERV__17780649] DEFAULT ((0.0)),
[_SERVICE_X57] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___SERV__186C2A82] DEFAULT ((0.0)),
[_SERVICE_X44] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___SERV__19604EBB] DEFAULT ((0.0)),
[_SERVICE_X75] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___SERV__1A5472F4] DEFAULT ((0.0)),
[_SERVICE_X62] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___SERV__1B48972D] DEFAULT ((0.0)),
[_SERVICE_X89] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___SERV__1C3CBB66] DEFAULT ((0.0)),
[_2211] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___2211__1D30DF9F] DEFAULT ((0.0)),
[_SERVICE_X81] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___SERV__1E2503D8] DEFAULT ((0.0)),
[_2213] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___2213__1F192811] DEFAULT ((0.0)),
[_2212] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___2212__200D4C4A] DEFAULT ((0.0)),
[_SERVICE_X90] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___SERV__21017083] DEFAULT ((0.0)),
[_SERVICE_X19] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___SERV__21F594BC] DEFAULT ((0.0)),
[_SERVICE_X48] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___SERV__22E9B8F5] DEFAULT ((0.0)),
[_SERVICE_X38] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___SERV__23DDDD2E] DEFAULT ((0.0)),
[_SERVICE_X17] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___SERV__24D20167] DEFAULT ((0.0)),
[_SERVICE_X35] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___SERV__25C625A0] DEFAULT ((0.0)),
[_SERVICE_X22] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___SERV__26BA49D9] DEFAULT ((0.0)),
[_SERVICE_X26] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___SERV__27AE6E12] DEFAULT ((0.0)),
[_CX_CORPOBJ] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_C__28A2924B] DEFAULT ((0.0)),
[_3293] [decimal] (23, 10) NULL,
[_1794] [decimal] (23, 10) NULL,
[_597] [decimal] (23, 10) NULL,
[_NEWHUD_X658] [decimal] (23, 10) NULL,
[_NEWHUD_X1350] [decimal] (23, 10) NULL,
[_NEWHUD_X1358] [decimal] (23, 10) NULL,
[_1774] [decimal] (23, 10) NULL,
[_1779] [decimal] (23, 10) NULL,
[_42] [decimal] (23, 10) NULL,
[_NEWHUD_X1414] [decimal] (23, 10) NULL,
[_579] [decimal] (23, 10) NULL,
[_565] [decimal] (23, 10) NULL,
[_599] [decimal] (23, 10) NULL,
[_1642] [decimal] (23, 10) NULL
) ON [PRIMARY]
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_NULLS ON
GO

CREATE TRIGGER [emdbuser].[ti_LOANXDB_N_07_Forklift_LoanSummary]
   ON  [emdbuser].[LOANXDB_N_07]
   AFTER INSERT
AS 
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;

	IF NOT EXISTS( SELECT 1 FROM emdbuser.LoanSummary ls JOIN inserted i ON i.XRefID = ls.XRefID)
	BEGIN

		INSERT INTO emdbuser.LoanSummary([Guid]
										,[LoanNumber]
										,[LoanFolder] 
										,[LoanName]
										,[Status]
										,[loanStatus]
										,[RateLockStatus]
										,[RateIsLocked]
										,[Investor]
										,[Broker]
										,XRefID
										,LastModified
										,TotalBuyPrice
										,TotalSellPrice)
		SELECT NEWID()
			  ,''
			  ,''
			  ,NEWID()
			  ,'A'
			  ,''
			  ,''
			  ,''
			  ,''
			  ,''
			  ,XRefID
			  ,GETDATE()
			  ,_2218
			  ,_2295
		FROM inserted i

	END
	ELSE

		UPDATE ls
		SET  TotalBuyPrice = i._2218
			,TotalSellPrice = i._2295
			,LastModified = GETDATE()
		FROM emdbuser.LoanSummary ls
		JOIN inserted i ON i.XRefID = ls.XRefID

	



END
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_NULLS ON
GO

CREATE TRIGGER [emdbuser].[tu_LOANXDB_N_07_Forklift_LoanSummary]
   ON  [emdbuser].[LOANXDB_N_07]
   AFTER UPDATE
AS 
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;

	IF (UPDATE(_2218) OR UPDATE(_2295))

		UPDATE ls
		SET  TotalBuyPrice = i._2218
			,TotalSellPrice = i._2295
			,LastModified = GETDATE()
		FROM emdbuser.LoanSummary ls
		JOIN inserted i ON i.XRefID = ls.XRefID

	
END
GO
ALTER TABLE [emdbuser].[LOANXDB_N_07] ADD CONSTRAINT [PK_LOANXDB_N_07_XrefId] PRIMARY KEY CLUSTERED  ([XrefId]) WITH (FILLFACTOR=80) ON [PRIMARY]
GO
