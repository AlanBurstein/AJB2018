CREATE TABLE [emdbuser].[LOANXDB_N_03]
(
[XrefId] [int] NOT NULL,
[_CX_PURFEES1_12] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_P__1723008E] DEFAULT ((0.0)),
[_CX_PURTOTAMT_12] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_P__181724C7] DEFAULT ((0.0)),
[_CX_PURMISC1_12] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_P__190B4900] DEFAULT ((0.0)),
[_CX_PURINT_12] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_P__19FF6D39] DEFAULT ((0.0)),
[_CX_PURFEES2_12] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_P__1AF39172] DEFAULT ((0.0)),
[_CX_PURCALCPX_12] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_P__1BE7B5AB] DEFAULT ((0.0)),
[_CX_PURCALOFWIRE_12] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_P__1CDBD9E4] DEFAULT ((0.0)),
[_L268] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___L268__1DCFFE1D] DEFAULT ((0.0)),
[_L202] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___L202__1EC42256] DEFAULT ((0.0)),
[_428] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N____428__1FB8468F] DEFAULT ((0.0)),
[_427] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N____427__20AC6AC8] DEFAULT ((0.0)),
[_1731] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___1731__21A08F01] DEFAULT ((0.0)),
[_1742] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___1742__2294B33A] DEFAULT ((0.0)),
[_1548] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___1548__2388D773] DEFAULT ((0.0)),
[_1784] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___1784__247CFBAC] DEFAULT ((0.0)),
[_HUD26] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___HUD2__25711FE5] DEFAULT ((0.0)),
[_RE88395_X318] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___RE88__2665441E] DEFAULT ((0.0)),
[_RE88395_X316] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___RE88__27596857] DEFAULT ((0.0)),
[_RE88395_X315] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___RE88__284D8C90] DEFAULT ((0.0)),
[_HUD24] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___HUD2__2941B0C9] DEFAULT ((0.0)),
[_1205] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___1205__2A35D502] DEFAULT ((0.0)),
[_CX_UWMIDFICOTRANS_15] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_U__2B29F93B] DEFAULT ((0.0)),
[_CX_UWMIDFICO_15] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_U__2C1E1D74] DEFAULT ((0.0)),
[_CX_YRSONJOB_15] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_Y__2D1241AD] DEFAULT ((0.0)),
[_CX_MIDDLECOFICO_14] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_M__2E0665E6] DEFAULT ((0.0)),
[_CX_ACTAPPRFEE_16] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_A__2EFA8A1F] DEFAULT ((0.0)),
[_CX_HPMLCALCRATE_16] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_H__2FEEAE58] DEFAULT ((0.0)),
[_CX_HPML30_16] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_H__30E2D291] DEFAULT ((0.0)),
[_CX_HPMLRATE_16] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_H__31D6F6CA] DEFAULT ((0.0)),
[_CX_HPML15_16] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_H__32CB1B03] DEFAULT ((0.0)),
[_CX_HPMLFINRATE_16] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_H__33BF3F3C] DEFAULT ((0.0)),
[_CX_HPMLRTPLUS_16] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_H__34B36375] DEFAULT ((0.0)),
[_CX_HPML30PREV_16] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_H__35A787AE] DEFAULT ((0.0)),
[_CX_HPMLRATEPREV_16] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_H__369BABE7] DEFAULT ((0.0)),
[_CX_HPML5PREV_16] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_H__378FD020] DEFAULT ((0.0)),
[_CX_HPML1PREV_16] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_H__3883F459] DEFAULT ((0.0)),
[_CX_HPMLCHG_16] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_H__39781892] DEFAULT ((0.0)),
[_CX_HPML15PREV_16] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_H__3A6C3CCB] DEFAULT ((0.0)),
[_CX_HPMLVAR_16] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_H__3B606104] DEFAULT ((0.0)),
[_CX_HPMLCALCRATEPR_16] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_H__3C54853D] DEFAULT ((0.0)),
[_CX_HPMLCHGPREV_16] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_H__3D48A976] DEFAULT ((0.0)),
[_CX_HPML1_16] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_H__3E3CCDAF] DEFAULT ((0.0)),
[_CX_HPML5_16] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_H__3F30F1E8] DEFAULT ((0.0)),
[_1724] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___1724__40251621] DEFAULT ((0.0)),
[_1827] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___1827__41193A5A] DEFAULT ((0.0)),
[_1699] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___1699__420D5E93] DEFAULT ((0.0)),
[_739] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N____739__430182CC] DEFAULT ((0.0)),
[_CX_HPMLFINAL_16] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_H__43F5A705] DEFAULT ((0.0)),
[_CX_HPML5HIS_16] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_H__44E9CB3E] DEFAULT ((0.0)),
[_CX_HPML15HIS_16] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_H__45DDEF77] DEFAULT ((0.0)),
[_CX_HPML1HIS_16] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_H__46D213B0] DEFAULT ((0.0)),
[_CX_HPML30HIS_16] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_H__47C637E9] DEFAULT ((0.0)),
[_331] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N____331__48BA5C22] DEFAULT ((0.0)),
[_1199] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___1199__49AE805B] DEFAULT ((0.0)),
[_VEND_X446] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___VEND__4AA2A494] DEFAULT ((0.0)),
[_VEND_X445] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___VEND__4B96C8CD] DEFAULT ((0.0)),
[_581] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N____581__4C8AED06] DEFAULT ((0.0)),
[_L230] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___L230__4D7F113F] DEFAULT ((0.0)),
[_595] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N____595__4E733578] DEFAULT ((0.0)),
[_L261] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___L261__4F6759B1] DEFAULT ((0.0)),
[_1622] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___1622__505B7DEA] DEFAULT ((0.0)),
[_596] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N____596__514FA223] DEFAULT ((0.0)),
[_L270] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___L270__5243C65C] DEFAULT ((0.0)),
[_CX_NETSHRTAGE] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_N__5337EA95] DEFAULT ((0.0)),
[_CX_LXFEES] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_L__542C0ECE] DEFAULT ((0.0)),
[_1693] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___1693__55203307] DEFAULT ((0.0)),
[_142] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N____142__56145740] DEFAULT ((0.0)),
[_1700] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___1700__57087B79] DEFAULT ((0.0)),
[_CX_UPFRONTYSP] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_U__57FC9FB2] DEFAULT ((0.0)),
[_3290] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___3290__58F0C3EB] DEFAULT ((0.0)),
[_3267] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___3267__59E4E824] DEFAULT ((0.0)),
[_3268] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___3268__5AD90C5D] DEFAULT ((0.0)),
[_NEWHUD_X1155] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___NEWH__5BCD3096] DEFAULT ((0.0)),
[_NEWHUD_X1152] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___NEWH__5CC154CF] DEFAULT ((0.0)),
[_NEWHUD_X1151] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___NEWH__5DB57908] DEFAULT ((0.0)),
[_NEWHUD_X1146] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___NEWH__5EA99D41] DEFAULT ((0.0)),
[_NEWHUD_X1144] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___NEWH__5F9DC17A] DEFAULT ((0.0)),
[_NEWHUD_X1142] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___NEWH__6091E5B3] DEFAULT ((0.0)),
[_NEWHUD_X1159] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___NEWH__618609EC] DEFAULT ((0.0)),
[_CX_NETPRICEEXP] [decimal] (23, 10) NULL CONSTRAINT [DF__LOANXDB_N___CX_N__627A2E25] DEFAULT ((0.0)),
[_CD2_XCCBO] [decimal] (23, 10) NULL,
[_NEWHUD_X1149] [decimal] (23, 10) NULL,
[_NEWHUD_X1165] [decimal] (23, 10) NULL,
[_NEWHUD_X1166] [decimal] (23, 10) NULL,
[_CD2_XSTLC] [decimal] (23, 10) NULL,
[_FV_X366] [decimal] (23, 10) NULL,
[_NEWHUD2_X9] [decimal] (23, 10) NULL,
[_CX_CC_TRK_TOTAL_CHARGED] [decimal] (23, 10) NULL,
[_CX_APPROVEDLEFEES] [decimal] (23, 10) NULL,
[_CD3_X20] [decimal] (23, 10) NULL,
[_CD3_X14] [decimal] (23, 10) NULL,
[_CD3_X18] [decimal] (23, 10) NULL,
[_CD3_X10] [decimal] (23, 10) NULL,
[_CD3_X12] [decimal] (23, 10) NULL,
[_CD3_X16] [decimal] (23, 10) NULL,
[_CX_CONDO_CREDIT_PAYMENT_AMT] [decimal] (23, 10) NULL,
[_CX_CONDO_PAYMENT_SERVICE_FEE] [decimal] (23, 10) NULL,
[_CD2_XSTG] [decimal] (23, 10) NULL,
[_NEWHUD2_X2921] [decimal] (23, 10) NULL,
[_NEWHUD2_X1698] [decimal] (23, 10) NULL
) ON [PRIMARY]
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_NULLS ON
GO

CREATE TRIGGER [emdbuser].[ti_LOANXDB_N_03_Forklift_LoanSummary]
   ON  [emdbuser].[LOANXDB_N_03]
   AFTER INSERT
AS 
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;

	IF NOT EXISTS( SELECT 1 FROM emdbuser.LoanSummary ls JOIN inserted i ON i.XRefID = ls.XRefID)
	BEGIN

		INSERT INTO emdbuser.LoanSummary([Guid]
										,[LoanNumber]
										,[LoanFolder] 
										,[LoanName]
										,[Status]
										,[loanStatus]
										,[RateLockStatus]
										,[RateIsLocked]
										,[Investor]
										,[Broker]
										,XRefID
										,LastModified
										,TotalLoanAmount
										,ARMFloorRate)
		SELECT NEWID()
			  ,''
			  ,''
			  ,NEWID()
			  ,'A'
			  ,''
			  ,''
			  ,''
			  ,''
			  ,''
			  ,XRefID
			  ,GETDATE()
			  ,_L202
			  ,_1699

		FROM inserted i

	END
	ELSE

		UPDATE ls
		SET  TotalLoanAmount = i._L202
			,ARMFloorRate = i._1699
			,LastModified = GETDATE()
		FROM emdbuser.LoanSummary ls
		JOIN inserted i ON i.XRefID = ls.XRefID

	



END
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_NULLS ON
GO

CREATE TRIGGER [emdbuser].[tu_LOANXDB_N_03_Forklift_LoanSummary]
   ON  [emdbuser].[LOANXDB_N_03]
   AFTER UPDATE
AS 
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;

	IF (UPDATE(_L202) OR UPDATE(_1699))

		UPDATE ls
		SET  TotalLoanAmount = i._L202
			,ARMFloorRate = i._1699
			,LastModified = GETDATE()
		FROM emdbuser.LoanSummary ls
		JOIN inserted i ON i.XRefID = ls.XRefID

	



END
GO
ALTER TABLE [emdbuser].[LOANXDB_N_03] ADD CONSTRAINT [PK_LOANXDB_N_03_XrefId] PRIMARY KEY CLUSTERED  ([XrefId]) WITH (FILLFACTOR=80) ON [PRIMARY]
GO
